{# expects: host, cats #}
{% if cats and cats|length > 0 %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "CollectionPage",
      "@id": "{{ host }}{{ request.path }}#collection",
      "name": "Shop",
      "url": "{{ host }}{{ request.path }}"
    },
    {
      "@type": "BreadcrumbList",
      "itemListElement": [
        { "@type": "ListItem", "position": 1, "name": "Home", "item": "{{ host }}/" },
        { "@type": "ListItem", "position": 2, "name": "Shop", "item": "{{ host }}{{ request.path }}" }
      ]
    },
    {
      "@type": "ItemList",
      "name": "Shop by Category",
      "itemListOrder": "https://schema.org/ItemListOrderAscending",
      "numberOfItems": {{ cats|length }},
      "itemListElement": [
        {% for c in cats %}
        {
          "@type": "CollectionPage",
          "position": {{ c.display_order|default:forloop.counter }},
          "name": "{{ c.name|escapejs }}",
          "url": "{{ host }}{{ c.get_absolute_url }}"{% if c.image %},
          "image": "{{ host }}{{ c.image.url }}"{% endif %}
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
      ]
    }
  ]
}
</script>
{% endif %}